version: "3.8"
services:
#  buscador-ui: es el proyecto de Angular
  buscador-ui:
    image: front-parcial
    ports:
      - 4200:80
    networks:
      pasionaria_network:
        aliases:
          - buscador-ui
    depends_on:
      - buscador-api
  # es una imagen base de mongo para almacenar algunos datos
  buscador-mongo:
    image: mongo
    ports:
      - 27017:27017
    networks:
      pasionaria_network:
        aliases:
          - buscador-mongo
  # es una imagen de postgresql para almacenar toda la data referida al proyecto y que sigue una estructura en concreto
  buscador-db:
    image: postgres:alpine3.17
    environment:
      - POSTGRES_PASSWORD=homito
    ports:
      - 6500:5432
    networks:
      pasionaria_network:
        aliases:
          - buscador-db
#  buscador-api: es el proyecto Java Spring Boot
  buscador-api:
    image: app-parcial
    ports:
      - 8080:8080
    environment:
#      postgresql
      SPRING_DATASOURCE_URL: jdbc:postgresql://buscador-db/pasionaria
      SPRING_DATASOURCE_USERNAME: postgres
      SPRING_DATASOURCE_PASSWORD: homito
#      mongodb
      SPRING_DATA_MONGODB_DATABASE: pasionaria
      SPRING_DATA_MONGODB_PORT: 27017
      SPRING_DATA_MONGODB_URI: mongodb://buscador-mongo/docker-db
    networks:
      pasionaria_network:
        aliases:
          - buscador-api
    depends_on:
      - buscador-mongo
      - buscador-db
networks:
  pasionaria_network:
    name: pasionaria_net
    driver: bridge
    ipam:
      driver: default